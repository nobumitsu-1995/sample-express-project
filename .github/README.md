## ディレクトリ構成

### 概要

#### 参考サイト

- https://zenn.dev/ikefukurou777/articles/65cfd0289ac74d
- https://qiita.com/sadnessOjisan/items/ea5590efa3f55ef56edd
- https://zenn.dev/kohii/articles/e4f325ed011db8

上記サイトを参考に、クリーンアーキテクチャの考えをよりシンプルに、柔軟に開発できるようカスタマイズしています。

下記のようなディレクトリ構造を考えています。

```
src
├─ Domain
│　├─ Entities
│　└─ Repositories
│
├─ Application
│　├─ Controllers
│　└─ Usecases
│
└─ Infrastructure
　 ├─ Routers
　 └─ Databases
```

### それぞれのレイヤーが担う責務

主に、以下の３つのレイヤーに分けられておりそれぞれが責務を分割している。

- **Domain**
  - 最重要ビジネスロジックがここに格納されている。この層にあるファイルは他ファイルに関心を持たない（依存しない）
  - ここに記述するコードはビジネス課題を中心に考える。DB 構造とかは一旦抜きで考える。
- **Application**
  - 全体の調整役みたいなイメージ。アプリケーションとして成り立たせるための実装
  - Domain 層の Entity とか Interface を実際に使用する層
- **Infrastructure**
  - フレームワークの機能や外部ツールとの連携をここで行う

より下層のディレクトリの責務については、後述の通りとなっています。

### Domain 層

- Entities:
  - アプリケーションで扱う重要なデータと、そのデータに関するビジネスルールを定義します。この層にあるコードは、他の層に依存せず、アプリケーションの中心となるロジックを持ちます。
- Repositories:
  - データの保存や取得に関する処理のインターフェースを定義します。実際のデータベース操作は他の層で行いますが、ここではその操作がどのように行われるかを抽象化します。

### Application 層

- Controllers:
  - 外部からのリクエスト（例: API リクエスト）を受け取り、適切なビジネスロジックを実行するための窓口となる部分です。リクエストを処理し、Usecases に渡す役割を担います。
- Usecases:
  - アプリケーションが実行する具体的なビジネスロジックを担当します。Domain 層のデータやルールを使って、ユーザーのリクエストに応じた操作を行います。

### Infrastructure 層

- Routers:
  - URL パスと Controllers をつなげる役割を持ちます。ユーザーからのリクエストがどのコントローラーに渡されるかを決定します。
- Databases:
  - 実際にデータを保存・取得する部分です。Domain 層で定義されたリポジトリインターフェースに従って、具体的なデータベース操作が実装されます。

## 開発HowTo

### prisma

#### マイグレーションの実行

DBのマイグレーションは以下コマンドで実行可能です。xxxの部分を適切な内容に変更して実行してください。
`npm run db:migrate -name=xxx`

#### シードの実行

DBの初期データ投入(シードの実行)は以下コマンドで可能です。初期データを修正したい場合は`prisma/seed.ts`を編集してください。
`npm run db:seed`

#### データのプレビュー

DB内に格納されているデータはstudioを仕様することで簡易的にブラウザで確認することが可能です。以下コマンドを仕様することで立ち上がります。
`npm run db:preview`
